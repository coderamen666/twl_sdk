<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=utf-8">
<META name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 7.0.0.0 for Windows">
<META http-equiv="Content-Style-Type" content="text/css">
<TITLE>TWL Nmenu</TITLE>
<LINK rel="stylesheet" href="../css/nitro.css" type="text/css">
<STYLE type="text/css">
<!--
.sample_source{
  background-color : #e8e8e8;
}
H3{
  color : teal;
}
pre
{
  display: compact;
  font-family	: "Courier New", monospace;
  font-weight	: normal;
  font-size     : normal;

/*  margin		: 0pt 0pt 6pt 50pt;*/
  padding		: 2pt 8pt 2pt 8pt;
  background-color	: #eee;

  border-style		: solid;
  border-width		: 1px;
}
.command_list{
  margin-bottom : 16pt;
}
.command_desc{
  }
.command_item{
  margin-top : 16pt;
  background-color : #e8e8e8;
}
.blockquoted_table {
  border : 1px;
  width : 80%;
}
TD,TH{
  border-color	: #c0d8d8;
  padding       : 1pt 4pt 1pt 4pt;
  border-width  : 1px;
  border-style  : solid;
}
div.screen
{
    float: left;
    padding: 2px;
    background-color: black;
    margin: 0 0.5em 1em 1em;
}
ol, ul
{
    padding-left: 4em;
    margin-left: 0pt;
}

div.screen img.main
{
    margin-bottom: 10px;
}
.warning
{
    color: red;
}
table
{
    left: 0;
}
table.plain td
{
    border: none;
    background-color: transparent;
}
-->
</STYLE>
</HEAD>
<BODY>

<H1 align="left">TWL Nmenu</H1>


<H2>Overview</H2>
<P>
　<CODE>TwlNmenu</CODE> is a TWL application that manages NAND applications in the TWL system. It can install NAND applications from TAD files on SD Cards or DS cards in the TWL system. It can start or delete NAND applications stored in the TWL system.
</P>


<H2>Execution</H2>
<H3></H3>
<P>
It can be run in the following ways:
</P>
<ul>
<li>Use the IS-TWL-DEBUGGER software to run <CODE>TwlNmenu.srl</CODE>.
<li>Use the IS-TWL-DEBUGGER software to import and then run <CODE>TwlNmenu.tad</CODE>.
<li>Write <CODE>TwlNmenu.srl</CODE> to a DS Game Card and then run it.
<li>Use TWL Nmenu to import and then run <CODE>TwlNmenu.tad</CODE>.
</ul>
<P>
If running the TWL Nmenu using the IS-TWL-DEBUGGER software, a &quot;Please wait a moment&quot; dialog box will be displayed, and you'll no longer be able to perform operations within the IS-TWL-DEBUGGER software. To exit, click <B>Force Quit</B> in the dialog box.
</P>

<H2>Storing TAD Files on a DS Card</h2>
<p>
NAND applications can be imported from a TAD file stored on a DS card when in <B>Card</B> mode. This is a description of how to prepare the DS card to be used at this time.
</p>
<p>
There are two methods.
</p>

<h5>Using the <CODE>-n</CODE> Option with <CODE>maketad</CODE></h5>
<p>
Although the <a href="../tools/maketad.html"><CODE>maketad</CODE></a> tool creates TAD files, using the <CODE>-n</CODE> option creates an SRL file that contains a TAD file instead of creating just a TAD file. Access the TAD file contained in the SRL file in <B>Card</B> mode by writing the SRL created with this option to a DS card.
</p>

<h5>Creating an Original SRL File</h5>
<p>
Access a TAD file included in the ROM-FS of an SRL file in <B>Card</B> mode by creating an SRL file that meets the following conditions and then writing it to a DS card.
</p>
<ul>
<li>It must be NITRO ROM.
<li>The company code must be &quot;YZ&quot;.
</ul>


<H2>Using the Tool</H2>
<p>
Once you are in TWL Nmenu, the upper screen will display some basic instructions and information about the currently selected file. The lower screen is used for displaying and selecting items in the list. Although display is usually in English, if the system language is Japanese (that is, if the market is Japan), some messages may appear in Japanese.<br>The TWL Nmenu is divided into three modes: <B>NAND</B>, <B>SD</B>, and <B>Card</B>. However, the <B>Card</B> mode is not available when Twl Nmenu is started as a card application. You can switch to the inactive mode either by touching the gray area at the top of the lower screen, or by pressing ← or → on the +Control Pad.
</p>

<h4>NAND Mode</h4>
<div class="screen"><img class="main" src="TwlNmenu/NAND_main_0.png"><br><img src="TwlNmenu/NAND_sub_0.png"></div>
<div class="screen"><img class="main" src="TwlNmenu/NAND_main_1.png"><br><img src="TwlNmenu/NAND_sub_1.png"></div>
<p>
In NAND mode, a list of NAND applications that are installed on the TWL system is displayed. In this mode, you can start or delete the selected NAND application.
</p>
<p>
Each item in the list displayed on the lower screen shows information about a NAND application in the following format:
</p>
<table class="plain" style="width:0"><tr><td>
<pre>
03. 01 4BNA (3031 34424e41) Ver.1.0
    -- ----  ---- --------      ---
    1  2     3    4             5
</pre>
</td></tr></table>
<table class="plain" style="width:25em"><tr><td>
<ol>
<li>Company Code (ASCII)
<li>Game Code (ASCII)
<li>Company Code (Hexadecimal)
<li>Game Code (Hexadecimal)
<li>NAND application version number
</ol>
</td></tr></table>
<p>
Light blue items in the list, for which &quot;deleted&quot; appears to the right, indicate NAND applications that have been deleted. Red items in the list, for which &quot;error&quot; appears to the right, indicate NAND applications that are invalid. You should delete and then reimport these items.
</p>

<br clear="left">

<p>
The controls for this mode are shown in the table below.
</p>

<table class="table">
<tbody>
<tr><th>Button<th>Operations
<tr><td>←→  <td>Mode Switching
<tr><td>↑↓  <td>Selects NAND applications.
<tr><td>START<td>Starts the selected NAND application.
<tr><td>Y<td>Clears the private save data of the selected NAND application.
<tr><td>X<td>Deletes the selected NAND application.
<tr><td>R + X<td>Deletes all NAND applications of the same type as the selected one.
<tr><td>L<td>Moves to the next page on the upper screen.
<tr><td>SELECT<td>Toggles between showing and hiding the description of the controls.
</tbody>
</table>

<p>
The following information is shown on the upper screen:
</p>

<p>
Page １
</p>
<table class="table">
<tbody>
<tr><th colspan="2">Item<th>Description
<tr><th colspan="2">Hardware<td>Displays information related to the TWL system.
<tr><th>  
<td>BoxCount<td>• <CODE>used</CODE> indicates the number of installed NAND applications.<br>• <CODE>free</CODE> indicates the remaining number of NAND applications that can be installed.
<tr><th colspan="2">Media<td>Displays information related to the system memory.
<tr><th rowspan="2">  
<td>Free<td>Displays the available space in blocks and KB.
<tr><td>Total<td>Displays the total space in blocks and KB.
</tbody>
</table>

<p>
Page ２
</p>
<table class="table">
<tbody>
<tr><th colspan="2">Item<th>Description
<tr><th colspan="2">Title<td>Displays information related to the selected NAND application.
<tr><th rowspan="8">  
<td>CompanyCode<td>Displays the Company Code in ASCII and hexadecimal.
<tr><td>InitialCode<td>Displays the Game Code in ASCII and hexadecimal.
<tr><td>GameVersion<td>Displays the game version.
<tr><td>TitleSize<td>Displays the space occupied by the NAND application in units of blocks and kilobytes.
<tr><td>AppSize<td>Displays the size of the SRL in blocks and KB.
<tr><td>PublicSave<td>Displays the size of the public save data in blocks and KB.
<tr><td>PrivateSave<td>Displays the size of the private save data in blocks and KB.
<tr><td>SubBanner<td>Displays the size of the sub-banner in blocks and in KB. When a sub-banner is configured, a fixed size of 16 KB is displayed. Otherwise, 0 KB is displayed.
</tbody>
</table>
<p>
The size occupied by the NAND application, <CODE>TitleSize</CODE>, is calculated using the following formula. This is not the sum of the displayed block counts, but rather the sum of the byte counts which is then converted into a block count.
</p>
<table class="plain" style="width:0"><tr><td>
<pre>
Size (in KB) occupied by a NAND application = SRL size (in KB) rounded up to 16 KB + 
                           the public save data size (in KB) + 
                           the private save data size (in KB) + 
                           the sub-banner size (in KB) + 
                           16 KB 
Size (in blocks) occupied by a NAND application = Size (in KB) occupied by the NAND application rounded up to 128 KB
</pre>
</td></tr></table>

<h5>Starting NAND Applications</h5>
<p>
Press START to run the selected NAND application. Once the NAND application is started, TWL Nmenu will give up all control. To return to TWL Nmenu, you must run TWL Nmenu again.
</p>

<h5>Deleting NAND Applications</h5>
<p>
Press the X Button to uninstall the selected NAND application from NAND. Even if a NAND application is deleted, information about the fact that it used to be installed remains within the TWL system. For applications in this state, only the Game Code will be displayed in light blue within the list on the lower screen. Furthermore, performing a <I>delete</I> operation on applications in this state will remove all traces of them.
</p>

<h5>Clearing the Private Save Data of NAND Applications</h5>
<p>
All private save data of the selected NAND application is deleted. The TWL system provides a feature that allows the user to back up NAND applications to SD Cards. However, the private save data region will not be backed up by this feature. Because the private save data is not backed up, it will be cleared when the system memory is restored from a backup. For this reason, NAND applications must consider the case in which only the private save data is cleared. This situation can be recreated by using TWL Nmenu to clear the private save data.
</p>

<h5>Deleting NAND Applications of the Same Type</h5>
<p>
When deleting NAND applications of the same type, delete all NAND applications that are the same as the selected NAND application from the perspective of whether the NAND applications have been deleted. For example, if an undeleted NAND application has been selected, all undeleted NAND applications will be deleted.
</p>


<br clear="all">

<h4>SD Mode<br>Card Mode</h4>
<div class="screen"><img class="main" src="TwlNmenu/SD_main_0.png"><br><img src="TwlNmenu/SD_sub_0.png"></div>
<div class="screen"><img class="main" src="TwlNmenu/SD_main_1.png"><br><img src="TwlNmenu/SD_sub_1.png"></div>
<p>
In <B>SD</B> mode and <B>Card</B> mode, the files on the SD Card or DS Card will be displayed on the lower screen.<br> In this mode, you can import TAD files.<FONT color=#ff0000> File and directory names are not displayed if they use characters that cannot be converted to Shift_JIS.</FONT>
</p>
<p>
<B>Card</B> mode can be used only when Twl Nmenu has been started as a NAND application. Furthermore, a DS card must be inserted into the card slot before Twl Nmenu is started. A DS card inserted after starting Twl Nmenu will not be recognized.
</p>
<p>
Each item in the list displayed on the lower screen shows information about a NAND application in the following format:
</p>
<table class="plain" style="width:0"><tr><td>
<pre>
05. 866,240  backupSample.tad
    -------  ----------------
    1        2
</pre>
</tr></td></table>
<table class="plain" style="width:30em"><tr><td>
<ol>
<li>File size or TAD file size in the directory
<li>File name or directory name
</ol>
</tr></td></table>

<br clear="left">

<p>
The controls for this mode are shown in the table below.
</p>

<table class="table">
<tbody>
<tr><th>Button<th>Operation
<tr><td>←→  <td>Switches modes.
<tr><td>↑↓  <td>Selects a file or directory.
<tr><td>A<td>Imports a TAD file when a TAD file is selected.<br>Moves to the given directory when a directory is selected.
<tr><td>B<td>Moves up one directory.
<tr><td>X<td>Moves to the root directory.
<tr><td>R + A<td>Imports all .tad files within the directory.
<tr><td>L<td>Moves to the next page on the upper screen.
<tr><td>SELECT<td>Toggles between showing and hiding the description of the controls.
</tbody>
</table>

<p>
The following information is shown on the upper screen:
</p>

<p>
Page １
</p>
<table class="table">
<tbody>
<tr><th colspan="2">Item<th>Description
<tr><th colspan="2">Hardware<td>Displays information related to the TWL system.
<tr><th>  
<td>BoxCount<td>• <CODE>used</CODE> indicates the number of installed NAND applications.<br>• <CODE>free</CODE> indicates the remaining number of NAND applications that can be installed.
<tr><th colspan="2">Media<td>Displays media-related information. This is always 0 in <B>Card</B> mode.
<tr><th rowspan="2">  
<td>Free<td>Displays the available space in blocks and KB.
<tr><td>Total<td>Displays the total space in blocks and KB.
</tbody>
</table>

<p>
Page ２
</p>
<table class="table">
<tbody>
<tr><th colspan="2">File<td>Displays information related to the selected file.
<tr><th rowspan="6">  
<td>CompanyCode<td>Displays the Company Code in ASCII and hexadecimal.
<tr><td>InitialCode<td>Displays the Game Code in ASCII and hexadecimal.
<tr><td>GameVersion<td>Displays the game version and the version that has been imported in the system memory.
<tr><td>FileName<td>Displays the file name.
<tr><td>LastUpdate<td>Displays the date last modified on the SD Card. This is always 0 in <B>Card</B> mode.
</tbody>
</table>

<h5>Importing TAD Files</h5>
<p>
Install a TAD file created with <a href="../tools/maketad.html"><CODE>maketad</CODE></a> in the TWL system. If a NAND application having the same game code is already installed, it will be overwritten.<br>Save data is initialized if any of the following are changed: the size of the public save data region, the size of the private save data region, or the presence of a sub-banner.
</p>

<h5>Importing TwlNmenu and NandFiler</h5>
<p>
When <CODE>TwlNmenu.tad</CODE> or <CODE>NandFiler.tad</CODE> is imported from the <CODE>$TwlSDK/bin/ARM9-TS/Rom</CODE> directory, the following error may be displayed.
</p>
<table class="plain" style="width:0"><tr><td>
<pre>
Failed to import ****.tad.
The data may be corrupt. (-1022)
</pre>
</tr></td></table>
<p>
In this case, you can normally install it by re-importing it.
</p>
<H2>Location</H2>
<P>
<CODE>$TwlSDK/bin/ARM9-TS/Rom/TwlNmenu.srl</CODE><br> <CODE>$TwlSDK/bin/ARM9-TS/Rom/TwlNmenu.tad</CODE><br>
</P>


<H2>See Also</H2>


<H2>Revision History</H2>
<P>
2009/08/20 Added a note regarding initialization of save data.<br>2009/05/27 Added a note about importing <CODE>TwlNmenu.tad</CODE> and <CODE>NandFiler.tad</CODE> files.<br>2009/05/22 Added SubBanner in NAND mode. Explained how <CODE>TitleSize</CODE> is calculated. <br>2009/04/30 Added a cautionary note about file and directory names in SD mode. <br>2008/10/16 Added information related to Card mode and displaying Japanese. <br>2008/07/11 Added support for a <CODE>TwlNmenu</CODE> update. <br>2008/04/25 Deleted ROM mode, Backup, and Restore. <br>2008/03/19 Made descriptions compliant with the terminology. Adjusted phrasing.<br>2007/12/20 Initial version.
</P>


<hr><p>CONFIDENTIAL</p></body>
</HTML>
