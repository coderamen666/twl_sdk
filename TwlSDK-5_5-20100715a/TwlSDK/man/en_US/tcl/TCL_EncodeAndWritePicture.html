<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta http-equiv="Content-Style-Type" content="text/css">
<title>TCL_EncodeAndWritePicture</title>
<link rel="stylesheet" href="../css/nitro.css" type="text/css">
</head>
<body>
<h1 align="left">TCL_EncodeAndWritePicture(Ex) <img src="../image/TWL.gif" align="middle"></h1>

<h2>Definition</h2>
<dl>
	<dd>
	<code>#include &lt;twl/tcl.h&gt;</code><br/>
	<br/>
	<pre><code>
TCLResult TCL_EncodeAndWritePicture( TCLAccessor* pAccessor ,
                                     const void* imageBuffer ,
                                     u8* jpegBuffer ,
                                     u32 jpegBufferSize ,
                                     u8* workBuffer ,
                                     u32 quality ,
                                     u32 option ,
                                     FSResult* pFSResult );

TCLResult TCL_EncodeAndWritePictureEx( TCLAccessor* pAccessor ,
                                       const void* imageBuffer ,
                                       u8* jpegBuffer ,
                                       u32 jpegBufferSize ,
                                       u8* workBuffer ,
                                       u32 quality ,
                                       u32 option ,
                                       u8* makerNoteBuffer ,
                                       u16 makerNoteBufferSize ,
                                       FSResult* pFSResult );
	</code></pre>
</dl>

<h2>Arguments</h2>
<p>
<table>
<tr><td><SPAN class="argument">pAccessor</SPAN><td><a href="TCLAccessor.html">Accessor</a>
<tr><td><SPAN class="argument">imageBuffer</SPAN><td>Source image buffer
<tr><td><SPAN class="argument">jpegBuffer</SPAN><td>JPEG image buffer
<tr><td><SPAN class="argument">jpegBufferSize</SPAN><td>Size of the JPEG image buffer
<tr><td><SPAN class="argument">workBuffer</SPAN><td>JPEG encoding work buffer
<tr><td><SPAN class="argument">quality</SPAN><td>JPEG encoding quality
<tr><td><SPAN class="argument">option</SPAN><td>JPEG encoding option
<tr><td><SPAN class="argument">makerNoteBuffer</SPAN><td>User maker note buffer
<tr><td><SPAN class="argument">makerNoteBufferSize</SPAN><td>User maker note buffer size
<tr><td><SPAN class="argument">pFSResult</SPAN><td>Processing result when an error has been generated by an FS function inside this function
</table>
</p>

<h2>Return Values</h2>
<p><a href="TCLResult.html">Processing result</a></p>

<h2>Description</h2>
<p>Encodes the source image data in JPEG and saves the data. Calls the <code>SSP_StartJpegEncoderFast</code> function.</p>
<p>The source image must have VGA dimensions.</p>
<p>The work buffer should allocate the size determined by the <a href="TCL_GetJpegEncoderBufferSize.html"><code>TCL_GetJpegEncoderBufferSize</code></a> function.</p>
<p>After encoding succeeds, saves to the JPEG image's next save path and overwrites the management file.</p>
<p>If this function returns <code>TCL_RESULT_ERROR_NO_NEXT_INDEX</code>, the JPEG image cannot be saved because of a path restriction. Note that this error is also returned when <a href="TCL_CalcNumEnableToTakePictures.html"><code>TCL_CalcNumEnableToTakePictures</code></a> is greater than 0.</p>
<p>The accessor must be initialized by the <a href="TCL_LoadTable.html"><code>TCL_LoadTable</code></a> or <a href="TCL_CreateTable.html"><code>TCL_CreateTable</code></a> function.</p>
<p>
If the encoding process failed because <CODE>jpegBufferSize</CODE> was small, <CODE>quality</CODE> was high, or for some other reason, the function will automatically lower <CODE>quality</CODE> internally and continue to retry until encoding is successful. If even lowering <CODE>quality</CODE> to its limit does not result in success, <CODE>TCL_RESULT_ERROR_OTHER</CODE> is returned.
</p>
<h2>See Also</h2>
<p><a href="TCL_GetJpegEncoderBufferSize.html"><code>TCL_GetJpegEncoderBufferSize</code></a></p>

<h2>Revision History</h2>
<p>
2009/06/29 Changed the SSP function that is called.<br> 2009/04/30 Changed the SSP function that is called.<br> 2009/04/16 Added description of operations when the internal encoder fails.<br> 2008/12/05 Initial version.
</p>

<hr><p>CONFIDENTIAL</p></body>
</html>
